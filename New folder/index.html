<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog Manager</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      color: white;
    }

    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.2);
    }

    .controls-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .filter-group, .search-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .filter-group label, .search-group label {
      font-weight: 600;
      color: #555;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .input-group {
      display: flex;
      gap: 10px;
    }

    select, input[type="text"], textarea {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid #e1e8ed;
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: white;
    }

    select:focus, input[type="text"]:focus, textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    button {
      padding: 12px 24px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    .btn-danger {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    }

    .btn-warning {
      background: linear-gradient(135deg, #feca57, #ff9ff3);
    }

    .form-section {
      background: linear-gradient(135deg, #f8f9ff, #e8f4f8);
    }

    .form-section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-section h2::before {
      content: "‚úçÔ∏è";
      font-size: 1.2rem;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-row label {
      font-weight: 600;
      color: #555;
      font-size: 0.9rem;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: #667eea;
    }

    .checkbox-group label {
      font-size: 1rem;
      color: #667eea;
      font-weight: 600;
    }

    .posts-section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .posts-section h2::before {
      content: "üìö";
      font-size: 1.2rem;
    }

    .post {
      background: linear-gradient(135deg, #ffffff, #f8f9ff);
      padding: 25px;
      margin-bottom: 20px;
      border-radius: 16px;
      border: 1px solid #e1e8ed;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .post::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
    }

    .post:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    }

    .post h3 {
      color: #333;
      margin-bottom: 10px;
      font-size: 1.3rem;
      font-weight: 700;
    }

    .post-meta {
      color: #666;
      font-size: 0.9rem;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .post-meta strong {
      color: #667eea;
    }

    .post p {
      margin-bottom: 15px;
      color: #555;
    }

    .post img {
      max-width: 200px;
      border-radius: 12px;
      margin: 15px 0;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }

    .post img:hover {
      transform: scale(1.05);
    }

    .post-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .post-actions a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      padding: 8px 16px;
      border: 2px solid #667eea;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .post-actions a:hover {
      background: #667eea;
      color: white;
    }

    .post-actions button {
      padding: 8px 16px;
      font-size: 12px;
      border-radius: 8px;
    }

    hr {
      display: none;
    }

    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin-top: 30px;
      padding: 20px;
      background: rgba(255,255,255,0.9);
      border-radius: 16px;
    }

    .pagination button {
      min-width: 80px;
    }

    .pagination span {
      color: #667eea;
      font-weight: 600;
      padding: 0 15px;
    }

    .search-results-title {
      color: #667eea;
      margin-bottom: 20px;
      padding: 15px;
      background: linear-gradient(135deg, #f0f4ff, #e8f4f8);
      border-radius: 12px;
      border-left: 4px solid #667eea;
    }

    textarea {
      min-height: 100px;
      resize: vertical;
      font-family: inherit;
    }

    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }

      .header h1 {
        font-size: 2rem;
      }

      .controls-section {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .card {
        padding: 20px;
      }

      .post-actions {
        justify-content: center;
      }
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #667eea;
      font-size: 1.1rem;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: #667eea;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìö Blog Manager</h1>
      <p>Create, manage, and organize your blog posts with style</p>
    </div>

    <!-- Controls Section -->
    <div class="card">
      <div class="controls-section">
        <div class="filter-group">
          <label for="categoryFilter">Filter by Category</label>
          <div class="input-group">
            <select id="categoryFilter"></select>
            <button onclick="loadPosts()">Apply Filter</button>
          </div>
        </div>

        <div class="search-group">
          <label for="searchQuery">Search Posts</label>
          <div class="input-group">
            <input type="text" id="searchQuery" placeholder="Search blog posts...">
            <button onclick="searchPosts()">Search</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Post Section -->
    <div class="card form-section">
      <h2>Create New Blog Post</h2>
      <form id="createPostForm">
        <div class="form-grid">
          <div class="form-row">
            <label for="title">Post Title</label>
            <input type="text" id="title" placeholder="Enter an engaging title" required>
          </div>
          <div class="form-row">
            <label for="writeDate">Write Date</label>
            <input type="text" id="writeDate" placeholder="YYYY-MM-DD" required>
          </div>
          <div class="form-row">
            <label for="category">Category</label>
            <input type="text" id="category" placeholder="e.g., Technology, Lifestyle" required>
          </div>
          <div class="form-row">
            <label for="author">Author Name</label>
            <input type="text" id="author" placeholder="Author's full name" required>
          </div>
          <div class="form-row">
            <label for="authorTitle">Author Title</label>
            <input type="text" id="authorTitle" placeholder="e.g., Senior Writer" required>
          </div>
          <div class="form-row">
            <label for="readTime">Read Time</label>
            <input type="text" id="readTime" placeholder="e.g., 5 min read" required>
          </div>
        </div>
        
        <div class="form-row">
          <label for="description">Description</label>
          <textarea id="description" placeholder="Write a compelling description of your post..." required></textarea>
        </div>
        
        <div class="form-grid">
          <div class="form-row">
            <label for="imageUrl">Image URL</label>
            <input type="text" id="imageUrl" placeholder="https://example.com/image.jpg" required>
          </div>
          <div class="form-row">
            <label for="moreInfoLink">More Info Link</label>
            <input type="text" id="moreInfoLink" placeholder="https://example.com/full-article" required>
          </div>
        </div>
        
        <div class="form-row">
          <label for="tags">Tags</label>
          <input type="text" id="tags" placeholder="tag1, tag2, tag3 (comma-separated)">
        </div>
        
        <div class="checkbox-group">
          <input type="checkbox" id="featured">
          <label for="featured">Mark as Featured Post</label>
        </div>
        
        <button type="submit" style="margin-top: 20px; width: 100%;">Create Blog Post</button>
      </form>
    </div>

    <!-- Blog Posts Section -->
    <div class="card posts-section">
      <h2>All Blog Posts</h2>
      <div id="posts"></div>
      
      <!-- Pagination -->
      <div id="pagination" class="pagination"></div>
    </div>
  </div>

  <script>
    const API_URL = "http://localhost:5000"; // change to your backend URL

    // Load categories
    async function loadCategories() {
      try {
        const res = await fetch(`${API_URL}/categories`);
        const categories = await res.json();
        const select = document.getElementById("categoryFilter");
        select.innerHTML = `<option value="all">All Categories</option>`;
        categories.forEach(cat => {
          select.innerHTML += `<option value="${cat.id}">${cat.name}</option>`;
        });
      } catch (error) {
        console.error('Error loading categories:', error);
      }
    }

    // Load posts
    async function loadPosts(page = 1) {
      try {
        const category = document.getElementById("categoryFilter").value || "all";
        const res = await fetch(`${API_URL}/blog-posts?category=${category}&page=${page}&limit=5`);
        const data = await res.json();

        const postsDiv = document.getElementById("posts");
        postsDiv.innerHTML = "";

        if (data.posts.length === 0) {
          postsDiv.innerHTML = `
            <div class="empty-state">
              <h3>No posts found</h3>
              <p>Create your first blog post to get started!</p>
            </div>
          `;
          document.getElementById("pagination").innerHTML = "";
          return;
        }

        data.posts.forEach(post => {
          postsDiv.innerHTML += `
            <div class="post">
              <h3>${post.title}</h3>
              <div class="post-meta">
                <strong>${post.author}</strong> ‚Ä¢ ${post.authorTitle} ‚Ä¢ ${post.readTime}
              </div>
              <p>${post.description}</p>
              <img src="${post.imageUrl}" alt="${post.title}">
              <div class="post-actions">
                <a href="${post.moreInfoLink}" target="_blank">Read Full Article</a>
                <button class="btn-warning" onclick="updatePost('${post._id}')">Update</button>
                <button class="btn-danger" onclick="deletePost('${post._id}')">Delete</button>
              </div>
            </div>
          `;
        });

        // Pagination
        const paginationDiv = document.getElementById("pagination");
        paginationDiv.innerHTML = "";
        if (data.pagination.hasPrev) {
          paginationDiv.innerHTML += `<button onclick="loadPosts(${data.pagination.currentPage - 1})">‚Üê Previous</button>`;
        }
        paginationDiv.innerHTML += `<span>Page ${data.pagination.currentPage} of ${data.pagination.totalPages}</span>`;
        if (data.pagination.hasNext) {
          paginationDiv.innerHTML += `<button onclick="loadPosts(${data.pagination.currentPage + 1})">Next ‚Üí</button>`;
        }
      } catch (error) {
        console.error('Error loading posts:', error);
        document.getElementById("posts").innerHTML = `<div class="empty-state"><h3>Error loading posts</h3><p>Please try again later.</p></div>`;
      }
    }

    // Search
    async function searchPosts(page = 1) {
      const query = document.getElementById("searchQuery").value;
      if (!query) return loadPosts();
      
      try {
        const res = await fetch(`${API_URL}/blog-posts/search/${query}?page=${page}&limit=5`);
        const data = await res.json();

        const postsDiv = document.getElementById("posts");
        postsDiv.innerHTML = `<div class="search-results-title">üîç Search Results for "${query}"</div>`;

        if (data.posts.length === 0) {
          postsDiv.innerHTML += `
            <div class="empty-state">
              <h3>No results found</h3>
              <p>Try different keywords or browse all posts.</p>
            </div>
          `;
          return;
        }

        data.posts.forEach(post => {
          postsDiv.innerHTML += `
            <div class="post">
              <h3>${post.title}</h3>
              <div class="post-meta">
                <strong>${post.author}</strong> ‚Ä¢ ${post.authorTitle} ‚Ä¢ ${post.readTime}
              </div>
              <p>${post.description}</p>
              <img src="${post.imageUrl}" alt="${post.title}">
              <div class="post-actions">
                <a href="${post.moreInfoLink}" target="_blank">Read Full Article</a>
                <button class="btn-warning" onclick="updatePost('${post._id}')">Update</button>
                <button class="btn-danger" onclick="deletePost('${post._id}')">Delete</button>
              </div>
            </div>
          `;
        });
      } catch (error) {
        console.error('Error searching posts:', error);
      }
    }

    // Create post
    document.getElementById("createPostForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const postData = {
        title: document.getElementById("title").value,
        writeDate: document.getElementById("writeDate").value,
        category: document.getElementById("category").value,
        author: document.getElementById("author").value,
        authorTitle: document.getElementById("authorTitle").value,
        readTime: document.getElementById("readTime").value,
        description: document.getElementById("description").value,
        imageUrl: document.getElementById("imageUrl").value,
        moreInfoLink: document.getElementById("moreInfoLink").value,
        tags: document.getElementById("tags").value.split(",").map(t => t.trim()),
        featured: document.getElementById("featured").checked
      };

      try {
        const res = await fetch(`${API_URL}/blog-posts`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(postData)
        });

        if (res.ok) {
          alert("‚úÖ Post created successfully!");
          loadPosts();
          e.target.reset();
        } else {
          alert("‚ùå Failed to create post");
        }
      } catch (error) {
        console.error('Error creating post:', error);
        alert("‚ùå Error creating post");
      }
    });

    // Delete post
    async function deletePost(id) {
      if (!confirm("üóëÔ∏è Are you sure you want to delete this post?")) return;
      
      try {
        const res = await fetch(`${API_URL}/blog-posts/${id}`, { method: "DELETE" });
        if (res.ok) {
          alert("‚úÖ Post deleted successfully");
          loadPosts();
        } else {
          alert("‚ùå Failed to delete post");
        }
      } catch (error) {
        console.error('Error deleting post:', error);
        alert("‚ùå Error deleting post");
      }
    }

    // Update post
    async function updatePost(id) {
      const newTitle = prompt("‚úèÔ∏è Enter new title:");
      if (!newTitle) return;
      
      try {
        const res = await fetch(`${API_URL}/blog-posts/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ title: newTitle })
        });
        
        if (res.ok) {
          alert("‚úÖ Post updated successfully!");
          loadPosts();
        } else {
          alert("‚ùå Failed to update post");
        }
      } catch (error) {
        console.error('Error updating post:', error);
        alert("‚ùå Error updating post");
      }
    }

    // Enhanced search on Enter key
    document.getElementById("searchQuery").addEventListener("keypress", function(e) {
      if (e.key === "Enter") {
        searchPosts();
      }
    });

    // Initialize
    loadCategories();
    loadPosts();
  </script>
</body>
</html>